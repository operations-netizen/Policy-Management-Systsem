"use client";
import {createContext,lazy,memo,useContext,isValidElement,useId,useTransition,useMemo,useState,useEffect,useCallback,Suspense,useRef}from'react';import {harden}from'rehype-harden';import pn from'rehype-raw';import un from'rehype-sanitize';import fn from'remark-gfm';import bn from'remend';import {jsx,jsxs,Fragment}from'react/jsx-runtime';import {clsx}from'clsx';import {twMerge}from'tailwind-merge';import {toJsxRuntime}from'hast-util-to-jsx-runtime';import Jo from'remark-parse';import Fo from'remark-rehype';import {unified}from'unified';import {Lexer}from'marked';var Yt=300,Qt="300px",eo=500;function Ve(e={}){let{immediate:t=false,debounceDelay:o=Yt,rootMargin:n=Qt,idleTimeout:d=eo}=e,[s,m]=useState(false),i=useRef(null),r=useRef(null),l=useRef(null),c=useMemo(()=>f=>{let a=Date.now();return window.setTimeout(()=>{f({didTimeout:false,timeRemaining:()=>Math.max(0,50-(Date.now()-a))});},1)},[]),u=useMemo(()=>typeof window!="undefined"&&window.requestIdleCallback?(f,a)=>window.requestIdleCallback(f,a):c,[c]),p=useMemo(()=>typeof window!="undefined"&&window.cancelIdleCallback?f=>window.cancelIdleCallback(f):f=>{clearTimeout(f);},[]);return useEffect(()=>{if(t){m(true);return}let f=i.current;if(!f)return;r.current&&(clearTimeout(r.current),r.current=null),l.current&&(p(l.current),l.current=null);let a=()=>{r.current&&(clearTimeout(r.current),r.current=null),l.current&&(p(l.current),l.current=null);},h=M=>{l.current=u(P=>{P.timeRemaining()>0||P.didTimeout?(m(true),M.disconnect()):l.current=u(()=>{m(true),M.disconnect();},{timeout:d/2});},{timeout:d});},y=M=>{a(),r.current=window.setTimeout(()=>{var L,D;let P=M.takeRecords();(P.length===0||(D=(L=P.at(-1))==null?void 0:L.isIntersecting)!=null&&D)&&h(M);},o);},k=(M,P)=>{M.isIntersecting?y(P):a();},C=new IntersectionObserver(M=>{for(let P of M)k(P,C);},{rootMargin:n,threshold:0});return C.observe(f),()=>{r.current&&clearTimeout(r.current),l.current&&p(l.current),C.disconnect();}},[t,o,n,d,p,u]),{shouldRender:s,containerRef:i}}var J=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M15.5607 3.99999L15.0303 4.53032L6.23744 13.3232C5.55403 14.0066 4.44599 14.0066 3.76257 13.3232L4.2929 12.7929L3.76257 13.3232L0.969676 10.5303L0.439346 9.99999L1.50001 8.93933L2.03034 9.46966L4.82323 12.2626C4.92086 12.3602 5.07915 12.3602 5.17678 12.2626L13.9697 3.46966L14.5 2.93933L15.5607 3.99999Z",fill:"currentColor",fillRule:"evenodd"})}),F=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M2.75 0.5C1.7835 0.5 1 1.2835 1 2.25V9.75C1 10.7165 1.7835 11.5 2.75 11.5H3.75H4.5V10H3.75H2.75C2.61193 10 2.5 9.88807 2.5 9.75V2.25C2.5 2.11193 2.61193 2 2.75 2H8.25C8.38807 2 8.5 2.11193 8.5 2.25V3H10V2.25C10 1.2835 9.2165 0.5 8.25 0.5H2.75ZM7.75 4.5C6.7835 4.5 6 5.2835 6 6.25V13.75C6 14.7165 6.7835 15.5 7.75 15.5H13.25C14.2165 15.5 15 14.7165 15 13.75V6.25C15 5.2835 14.2165 4.5 13.25 4.5H7.75ZM7.5 6.25C7.5 6.11193 7.61193 6 7.75 6H13.25C13.3881 6 13.5 6.11193 13.5 6.25V13.75C13.5 13.8881 13.3881 14 13.25 14H7.75C7.61193 14 7.5 13.8881 7.5 13.75V6.25Z",fill:"currentColor",fillRule:"evenodd"})}),z=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M8.75 1V1.75V8.68934L10.7197 6.71967L11.25 6.18934L12.3107 7.25L11.7803 7.78033L8.70711 10.8536C8.31658 11.2441 7.68342 11.2441 7.29289 10.8536L4.21967 7.78033L3.68934 7.25L4.75 6.18934L5.28033 6.71967L7.25 8.68934V1.75V1H8.75ZM13.5 9.25V13.5H2.5V9.25V8.5H1V9.25V14C1 14.5523 1.44771 15 2 15H14C14.5523 15 15 14.5523 15 14V9.25V8.5H13.5V9.25Z",fill:"currentColor",fillRule:"evenodd"})}),Be=e=>jsxs("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:[jsx("path",{d:"M8 0V4",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M8 16V12",opacity:"0.5",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M3.29773 1.52783L5.64887 4.7639",opacity:"0.9",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M12.7023 1.52783L10.3511 4.7639",opacity:"0.1",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M12.7023 14.472L10.3511 11.236",opacity:"0.4",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M3.29773 14.472L5.64887 11.236",opacity:"0.6",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M15.6085 5.52783L11.8043 6.7639",opacity:"0.2",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M0.391602 10.472L4.19583 9.23598",opacity:"0.7",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M15.6085 10.4722L11.8043 9.2361",opacity:"0.3",stroke:"currentColor",strokeWidth:"1.5"}),jsx("path",{d:"M0.391602 5.52783L4.19583 6.7639",opacity:"0.8",stroke:"currentColor",strokeWidth:"1.5"})]}),je=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M1 5.25V6H2.5V5.25V2.5H5.25H6V1H5.25H2C1.44772 1 1 1.44772 1 2V5.25ZM5.25 14.9994H6V13.4994H5.25H2.5V10.7494V9.99939H1V10.7494V13.9994C1 14.5517 1.44772 14.9994 2 14.9994H5.25ZM15 10V10.75V14C15 14.5523 14.5523 15 14 15H10.75H10V13.5H10.75H13.5V10.75V10H15ZM10.75 1H10V2.5H10.75H13.5V5.25V6H15V5.25V2C15 1.44772 14.5523 1 14 1H10.75Z",fill:"currentColor",fillRule:"evenodd"})}),Oe=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M13.5 8C13.5 4.96643 11.0257 2.5 7.96452 2.5C5.42843 2.5 3.29365 4.19393 2.63724 6.5H5.25H6V8H5.25H0.75C0.335787 8 0 7.66421 0 7.25V2.75V2H1.5V2.75V5.23347C2.57851 2.74164 5.06835 1 7.96452 1C11.8461 1 15 4.13001 15 8C15 11.87 11.8461 15 7.96452 15C5.62368 15 3.54872 13.8617 2.27046 12.1122L1.828 11.5066L3.03915 10.6217L3.48161 11.2273C4.48831 12.6051 6.12055 13.5 7.96452 13.5C11.0257 13.5 13.5 11.0336 13.5 8Z",fill:"currentColor",fillRule:"evenodd"})}),re=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M12.4697 13.5303L13 14.0607L14.0607 13L13.5303 12.4697L9.06065 7.99999L13.5303 3.53032L14.0607 2.99999L13 1.93933L12.4697 2.46966L7.99999 6.93933L3.53032 2.46966L2.99999 1.93933L1.93933 2.99999L2.46966 3.53032L6.93933 7.99999L2.46966 12.4697L1.93933 13L2.99999 14.0607L3.53032 13.5303L7.99999 9.06065L12.4697 13.5303Z",fill:"currentColor",fillRule:"evenodd"})}),ve=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M13.5 10.25V13.25C13.5 13.3881 13.3881 13.5 13.25 13.5H2.75C2.61193 13.5 2.5 13.3881 2.5 13.25L2.5 2.75C2.5 2.61193 2.61193 2.5 2.75 2.5H5.75H6.5V1H5.75H2.75C1.7835 1 1 1.7835 1 2.75V13.25C1 14.2165 1.7835 15 2.75 15H13.25C14.2165 15 15 14.2165 15 13.25V10.25V9.5H13.5V10.25ZM9 1H9.75H14.2495C14.6637 1 14.9995 1.33579 14.9995 1.75V6.25V7H13.4995V6.25V3.56066L8.53033 8.52978L8 9.06011L6.93934 7.99945L7.46967 7.46912L12.4388 2.5H9.75H9V1Z",fill:"currentColor",fillRule:"evenodd"})}),Ae=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M1.5 6.5C1.5 3.73858 3.73858 1.5 6.5 1.5C9.26142 1.5 11.5 3.73858 11.5 6.5C11.5 9.26142 9.26142 11.5 6.5 11.5C3.73858 11.5 1.5 9.26142 1.5 6.5ZM6.5 0C2.91015 0 0 2.91015 0 6.5C0 10.0899 2.91015 13 6.5 13C8.02469 13 9.42677 12.475 10.5353 11.596L13.9697 15.0303L14.5 15.5607L15.5607 14.5L15.0303 13.9697L11.596 10.5353C12.475 9.42677 13 8.02469 13 6.5C13 2.91015 10.0899 0 6.5 0ZM4.125 5.875H4.75H5.875V4.75V4.125H7.125V4.75V5.875H8.25H8.875V7.125H8.25H7.125V8.25V8.875H5.875V8.25V7.125H4.75H4.125V5.875Z",fill:"currentColor",fillRule:"evenodd"})}),qe=e=>jsx("svg",{color:"currentColor",height:16,strokeLinejoin:"round",viewBox:"0 0 16 16",width:16,...e,children:jsx("path",{clipRule:"evenodd",d:"M15.5607 3.99999L15.0303 4.53032L6.23744 13.3232C5.55403 14.0066 4.44599 14.0066 3.76257 13.3232L4.2929 12.7929L3.76257 13.3232L0.969676 10.5303L0.439346 9.99999L1.50001 8.93933L2.03034 9.46966L4.82323 12.2626C4.92086 12.3602 5.07915 12.3602 5.17678 12.2626L13.9697 3.46966L14.5 2.93933L15.5607 3.99999Z",fill:"currentColor",fillRule:"evenodd"})});var b=(...e)=>twMerge(clsx(e)),B=(e,t,o)=>{let n=typeof t=="string"?new Blob([t],{type:o}):t,d=URL.createObjectURL(n),s=document.createElement("a");s.href=d,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(d);};var ao=createContext({code:""}),se=()=>useContext(ao);var Ce=({onCopy:e,onError:t,timeout:o=2e3,children:n,className:d,code:s,...m})=>{let[i,r]=useState(false),l=useRef(0),{code:c}=se(),{isAnimating:u}=useContext(N),p=s!=null?s:c,f=async()=>{var h;if(typeof window=="undefined"||!((h=navigator==null?void 0:navigator.clipboard)!=null&&h.writeText)){t==null||t(new Error("Clipboard API not available"));return}try{i||(await navigator.clipboard.writeText(p),r(!0),e==null||e(),l.current=window.setTimeout(()=>r(!1),o));}catch(y){t==null||t(y);}};useEffect(()=>()=>{window.clearTimeout(l.current);},[]);let a=i?J:F;return jsx("button",{className:b("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",d),"data-streamdown":"code-block-copy-button",disabled:u,onClick:f,title:"Copy Code",type:"button",...m,children:n!=null?n:jsx(a,{size:14})})};var $e={"1c":"1c","1c-query":"1cq",abap:"abap","actionscript-3":"as",ada:"ada",adoc:"adoc","angular-html":"html","angular-ts":"ts",apache:"conf",apex:"cls",apl:"apl",applescript:"applescript",ara:"ara",asciidoc:"adoc",asm:"asm",astro:"astro",awk:"awk",ballerina:"bal",bash:"sh",bat:"bat",batch:"bat",be:"be",beancount:"beancount",berry:"berry",bibtex:"bib",bicep:"bicep",blade:"blade.php",bsl:"bsl",c:"c","c#":"cs","c++":"cpp",cadence:"cdc",cairo:"cairo",cdc:"cdc",clarity:"clar",clj:"clj",clojure:"clj","closure-templates":"soy",cmake:"cmake",cmd:"cmd",cobol:"cob",codeowners:"CODEOWNERS",codeql:"ql",coffee:"coffee",coffeescript:"coffee","common-lisp":"lisp",console:"sh",coq:"v",cpp:"cpp",cql:"cql",crystal:"cr",cs:"cs",csharp:"cs",css:"css",csv:"csv",cue:"cue",cypher:"cql",d:"d",dart:"dart",dax:"dax",desktop:"desktop",diff:"diff",docker:"dockerfile",dockerfile:"dockerfile",dotenv:"env","dream-maker":"dm",edge:"edge",elisp:"el",elixir:"ex",elm:"elm","emacs-lisp":"el",erb:"erb",erl:"erl",erlang:"erl",f:"f","f#":"fs",f03:"f03",f08:"f08",f18:"f18",f77:"f77",f90:"f90",f95:"f95",fennel:"fnl",fish:"fish",fluent:"ftl",for:"for","fortran-fixed-form":"f","fortran-free-form":"f90",fs:"fs",fsharp:"fs",fsl:"fsl",ftl:"ftl",gdresource:"tres",gdscript:"gd",gdshader:"gdshader",genie:"gs",gherkin:"feature","git-commit":"gitcommit","git-rebase":"gitrebase",gjs:"js",gleam:"gleam","glimmer-js":"js","glimmer-ts":"ts",glsl:"glsl",gnuplot:"plt",go:"go",gql:"gql",graphql:"graphql",groovy:"groovy",gts:"gts",hack:"hack",haml:"haml",handlebars:"hbs",haskell:"hs",haxe:"hx",hbs:"hbs",hcl:"hcl",hjson:"hjson",hlsl:"hlsl",hs:"hs",html:"html","html-derivative":"html",http:"http",hxml:"hxml",hy:"hy",imba:"imba",ini:"ini",jade:"jade",java:"java",javascript:"js",jinja:"jinja",jison:"jison",jl:"jl",js:"js",json:"json",json5:"json5",jsonc:"jsonc",jsonl:"jsonl",jsonnet:"jsonnet",jssm:"jssm",jsx:"jsx",julia:"jl",kotlin:"kt",kql:"kql",kt:"kt",kts:"kts",kusto:"kql",latex:"tex",lean:"lean",lean4:"lean",less:"less",liquid:"liquid",lisp:"lisp",lit:"lit",llvm:"ll",log:"log",logo:"logo",lua:"lua",luau:"luau",make:"mak",makefile:"mak",markdown:"md",marko:"marko",matlab:"m",md:"md",mdc:"mdc",mdx:"mdx",mediawiki:"wiki",mermaid:"mmd",mips:"s",mipsasm:"s",mmd:"mmd",mojo:"mojo",move:"move",nar:"nar",narrat:"narrat",nextflow:"nf",nf:"nf",nginx:"conf",nim:"nim",nix:"nix",nu:"nu",nushell:"nu",objc:"m","objective-c":"m","objective-cpp":"mm",ocaml:"ml",pascal:"pas",perl:"pl",perl6:"p6",php:"php",plsql:"pls",po:"po",polar:"polar",postcss:"pcss",pot:"pot",potx:"potx",powerquery:"pq",powershell:"ps1",prisma:"prisma",prolog:"pl",properties:"properties",proto:"proto",protobuf:"proto",ps:"ps",ps1:"ps1",pug:"pug",puppet:"pp",purescript:"purs",py:"py",python:"py",ql:"ql",qml:"qml",qmldir:"qmldir",qss:"qss",r:"r",racket:"rkt",raku:"raku",razor:"cshtml",rb:"rb",reg:"reg",regex:"regex",regexp:"regexp",rel:"rel",riscv:"s",rs:"rs",rst:"rst",ruby:"rb",rust:"rs",sas:"sas",sass:"sass",scala:"scala",scheme:"scm",scss:"scss",sdbl:"sdbl",sh:"sh",shader:"shader",shaderlab:"shader",shell:"sh",shellscript:"sh",shellsession:"sh",smalltalk:"st",solidity:"sol",soy:"soy",sparql:"rq",spl:"spl",splunk:"spl",sql:"sql","ssh-config":"config",stata:"do",styl:"styl",stylus:"styl",svelte:"svelte",swift:"swift","system-verilog":"sv",systemd:"service",talon:"talon",talonscript:"talon",tasl:"tasl",tcl:"tcl",templ:"templ",terraform:"tf",tex:"tex",tf:"tf",tfvars:"tfvars",toml:"toml",ts:"ts","ts-tags":"ts",tsp:"tsp",tsv:"tsv",tsx:"tsx",turtle:"ttl",twig:"twig",typ:"typ",typescript:"ts",typespec:"tsp",typst:"typ",v:"v",vala:"vala",vb:"vb",verilog:"v",vhdl:"vhdl",vim:"vim",viml:"vim",vimscript:"vim",vue:"vue","vue-html":"html","vue-vine":"vine",vy:"vy",vyper:"vy",wasm:"wasm",wenyan:"wy",wgsl:"wgsl",wiki:"wiki",wikitext:"wiki",wit:"wit",wl:"wl",wolfram:"wl",xml:"xml",xsl:"xsl",yaml:"yaml",yml:"yml",zenscript:"zs",zig:"zig",zsh:"zsh",\u6587\u8A00:"wy"},We=({onDownload:e,onError:t,language:o,children:n,className:d,code:s,...m})=>{let{code:i}=se(),{isAnimating:r}=useContext(N),l=s!=null?s:i,u=`file.${o&&o in $e?$e[o]:"txt"}`,p="text/plain",f=()=>{try{B(u,l,p),e==null||e();}catch(a){t==null||t(a);}};return jsx("button",{className:b("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",d),"data-streamdown":"code-block-download-button",disabled:r,onClick:f,title:"Download file",type:"button",...m,children:n!=null?n:jsx(z,{size:14})})};var Pe=()=>jsxs("div",{className:"w-full divide-y divide-border overflow-hidden rounded-xl border border-border",children:[jsx("div",{className:"h-[46px] w-full bg-muted/80"}),jsx("div",{className:"flex w-full items-center justify-center p-4",children:jsx(Be,{className:"size-4 animate-spin"})})]});var fo=/\.[^/.]+$/,Xe=({node:e,className:t,src:o,alt:n,...d})=>{let s=async()=>{if(o)try{let i=await(await fetch(o)).blob(),l=new URL(o,window.location.origin).pathname.split("/").pop()||"",c=l.split(".").pop(),u=l.includes(".")&&c!==void 0&&c.length<=4,p="";if(u)p=l;else {let f=i.type,a="png";f.includes("jpeg")||f.includes("jpg")?a="jpg":f.includes("png")?a="png":f.includes("svg")?a="svg":f.includes("gif")?a="gif":f.includes("webp")&&(a="webp"),p=`${(n||l||"image").replace(fo,"")}.${a}`;}B(p,i,i.type);}catch(m){window.open(o,"_blank");}};return o?jsxs("div",{className:"group relative my-4 inline-block","data-streamdown":"image-wrapper",children:[jsx("img",{alt:n,className:b("max-w-full rounded-lg",t),"data-streamdown":"image",src:o,...d}),jsx("div",{className:"pointer-events-none absolute inset-0 hidden rounded-lg bg-black/10 group-hover:block"}),jsx("button",{className:b("absolute right-2 bottom-2 flex h-8 w-8 cursor-pointer items-center justify-center rounded-md border border-border bg-background/90 shadow-sm backdrop-blur-sm transition-all duration-200 hover:bg-background","opacity-0 group-hover:opacity-100"),onClick:s,title:"Download image",type:"button",children:jsx(z,{size:14})})]}):null};var Q=0,yo=()=>{Q+=1,Q===1&&(document.body.style.overflow="hidden");},wo=()=>{Q=Math.max(0,Q-1),Q===0&&(document.body.style.overflow="");},Fe=({url:e,isOpen:t,onClose:o,onConfirm:n})=>{let[d,s]=useState(false),m=useCallback(async()=>{try{await navigator.clipboard.writeText(e),s(!0),setTimeout(()=>s(!1),2e3);}catch(r){}},[e]),i=useCallback(()=>{n(),o();},[n,o]);return useEffect(()=>{if(t){yo();let r=l=>{l.key==="Escape"&&o();};return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r),wo();}}},[t,o]),t?jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/50 backdrop-blur-sm","data-streamdown":"link-safety-modal",onClick:o,onKeyDown:r=>{r.key==="Escape"&&o();},role:"button",tabIndex:0,children:jsxs("div",{className:"relative mx-4 flex w-full max-w-md flex-col gap-4 rounded-xl border bg-background p-6 shadow-lg",onClick:r=>r.stopPropagation(),onKeyDown:r=>r.stopPropagation(),role:"presentation",children:[jsx("button",{className:"absolute top-4 right-4 rounded-md p-1 text-muted-foreground transition-all hover:bg-muted hover:text-foreground",onClick:o,title:"Close",type:"button",children:jsx(re,{size:16})}),jsxs("div",{className:"flex flex-col gap-2",children:[jsxs("div",{className:"flex items-center gap-2 font-semibold text-lg",children:[jsx(ve,{size:20}),jsx("span",{children:"Open external link?"})]}),jsx("p",{className:"text-muted-foreground text-sm",children:"You're about to visit an external website."})]}),jsx("div",{className:b("break-all rounded-md bg-muted p-3 font-mono text-sm",e.length>100&&"max-h-32 overflow-y-auto"),children:e}),jsxs("div",{className:"flex gap-2",children:[jsx("button",{className:"flex flex-1 items-center justify-center gap-2 rounded-md border bg-background px-4 py-2 font-medium text-sm transition-all hover:bg-muted",onClick:m,type:"button",children:d?jsxs(Fragment,{children:[jsx(J,{size:14}),jsx("span",{children:"Copied"})]}):jsxs(Fragment,{children:[jsx(F,{size:14}),jsx("span",{children:"Copy link"})]})}),jsxs("button",{className:"flex flex-1 items-center justify-center gap-2 rounded-md bg-primary px-4 py-2 font-medium text-primary-foreground text-sm transition-all hover:bg-primary/90",onClick:i,type:"button",children:[jsx(ve,{size:14}),jsx("span",{children:"Open link"})]})]})]})}):null};var ie=createContext(null),Ue=()=>useContext(ie),cr=()=>{var t;let e=Ue();return (t=e==null?void 0:e.code)!=null?t:null},U=()=>{var t;let e=Ue();return (t=e==null?void 0:e.mermaid)!=null?t:null};var Ke=(e,t)=>{var n;let o=(n=void 0)!=null?n:5;return new Promise((d,s)=>{let m="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e))),i=new Image;i.crossOrigin="anonymous",i.onload=()=>{let r=document.createElement("canvas"),l=i.width*o,c=i.height*o;r.width=l,r.height=c;let u=r.getContext("2d");if(!u){s(new Error("Failed to create 2D canvas context for PNG export"));return}u.drawImage(i,0,0,l,c),r.toBlob(p=>{if(!p){s(new Error("Failed to create PNG blob"));return}d(p);},"image/png");},i.onerror=()=>s(new Error("Failed to load SVG image")),i.src=m;})};var Ye=({chart:e,children:t,className:o,onDownload:n,config:d,onError:s})=>{let[m,i]=useState(false),r=useRef(null),{isAnimating:l}=useContext(N),c=U(),u=async p=>{try{if(p==="mmd"){B("diagram.mmd",e,"text/plain"),i(!1),n==null||n(p);return}if(!c){s==null||s(new Error("Mermaid plugin not available"));return}let f=c.getMermaid(d),a=e.split("").reduce((k,C)=>(k<<5)-k+C.charCodeAt(0)|0,0),h=`mermaid-${Math.abs(a)}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{svg:y}=await f.render(h,e);if(!y){s==null||s(new Error("SVG not found. Please wait for the diagram to render."));return}if(p==="svg"){B("diagram.svg",y,"image/svg+xml"),i(!1),n==null||n(p);return}if(p==="png"){let k=await Ke(y);B("diagram.png",k,"image/png"),n==null||n(p),i(!1);return}}catch(f){s==null||s(f);}};return useEffect(()=>{let p=f=>{let a=f.composedPath();r.current&&!a.includes(r.current)&&i(false);};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p);}},[]),jsxs("div",{className:"relative",ref:r,children:[jsx("button",{className:b("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",o),disabled:l,onClick:()=>i(!m),title:"Download diagram",type:"button",children:t!=null?t:jsx(z,{size:14})}),m?jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>u("svg"),title:"Download diagram as SVG",type:"button",children:"SVG"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>u("png"),title:"Download diagram as PNG",type:"button",children:"PNG"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>u("mmd"),title:"Download diagram as MMD",type:"button",children:"MMD"})]}):null]})};var te=0,Lo=()=>{te+=1,te===1&&(document.body.style.overflow="hidden");},So=()=>{te=Math.max(0,te-1),te===0&&(document.body.style.overflow="");},ot=({chart:e,config:t,onFullscreen:o,onExit:n,className:d,...s})=>{let[m,i]=useState(false),{isAnimating:r,controls:l}=useContext(N),c=(()=>{if(typeof l=="boolean")return l;let p=l.mermaid;return p===false?false:p===true||p===void 0?true:p.panZoom!==false})(),u=()=>{i(!m);};return useEffect(()=>{if(m){Lo();let p=f=>{f.key==="Escape"&&i(false);};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p),So();}}},[m]),useEffect(()=>{m?o==null||o():n&&n();},[m,o,n]),jsxs(Fragment,{children:[jsx("button",{className:b("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",d),disabled:r,onClick:u,title:"View fullscreen",type:"button",...s,children:jsx(je,{size:14})}),m?jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/95 backdrop-blur-sm",onClick:u,onKeyDown:p=>{p.key==="Escape"&&u();},role:"button",tabIndex:0,children:[jsx("button",{className:"absolute top-4 right-4 z-10 rounded-md p-2 text-muted-foreground transition-all hover:bg-muted hover:text-foreground",onClick:u,title:"Exit fullscreen",type:"button",children:jsx(re,{size:20})}),jsx("div",{className:"flex size-full items-center justify-center p-4",onClick:p=>p.stopPropagation(),onKeyDown:p=>p.stopPropagation(),role:"presentation",children:jsx(tt,{chart:e,className:"size-full [&_svg]:h-auto [&_svg]:w-auto",config:t,fullscreen:true,showControls:c})})]}):null]})};var le=e=>{var s,m;let t=[],o=[],n=e.querySelectorAll("thead th");for(let i of n)t.push(((s=i.textContent)==null?void 0:s.trim())||"");let d=e.querySelectorAll("tbody tr");for(let i of d){let r=[],l=i.querySelectorAll("td");for(let c of l)r.push(((m=c.textContent)==null?void 0:m.trim())||"");o.push(r);}return {headers:t,rows:o}},ce=e=>{let{headers:t,rows:o}=e,n=i=>{let r=false,l=false;for(let c of i){if(c==='"'){r=true,l=true;break}(c===","||c===`
`)&&(r=true);}return r?l?`"${i.replace(/"/g,'""')}"`:`"${i}"`:i},d=t.length>0?o.length+1:o.length,s=new Array(d),m=0;t.length>0&&(s[m]=t.map(n).join(","),m+=1);for(let i of o)s[m]=i.map(n).join(","),m+=1;return s.join(`
`)},nt=e=>{let{headers:t,rows:o}=e,n=i=>{let r=false;for(let c of i)if(c==="	"||c===`
`||c==="\r"){r=true;break}if(!r)return i;let l=[];for(let c of i)c==="	"?l.push("\\t"):c===`
`?l.push("\\n"):c==="\r"?l.push("\\r"):l.push(c);return l.join("")},d=t.length>0?o.length+1:o.length,s=new Array(d),m=0;t.length>0&&(s[m]=t.map(n).join("	"),m+=1);for(let i of o)s[m]=i.map(n).join("	"),m+=1;return s.join(`
`)},Me=e=>{let t=false;for(let n of e)if(n==="\\"||n==="|"){t=true;break}if(!t)return e;let o=[];for(let n of e)n==="\\"?o.push("\\\\"):n==="|"?o.push("\\|"):o.push(n);return o.join("")},rt=e=>{let{headers:t,rows:o}=e;if(t.length===0)return "";let n=new Array(o.length+2),d=0,s=t.map(i=>Me(i));n[d]=`| ${s.join(" | ")} |`,d+=1;let m=new Array(t.length);for(let i=0;i<t.length;i+=1)m[i]="---";n[d]=`| ${m.join(" | ")} |`,d+=1;for(let i of o)if(i.length<t.length){let r=new Array(t.length);for(let l=0;l<t.length;l+=1)r[l]=l<i.length?Me(i[l]):"";n[d]=`| ${r.join(" | ")} |`,d+=1;}else {let r=i.map(l=>Me(l));n[d]=`| ${r.join(" | ")} |`,d+=1;}return n.join(`
`)};var lt=({children:e,className:t,onCopy:o,onError:n,timeout:d=2e3})=>{let[s,m]=useState(false),[i,r]=useState(false),l=useRef(null),c=useRef(0),{isAnimating:u}=useContext(N),p=async a=>{var h,y;if(typeof window=="undefined"||!((h=navigator==null?void 0:navigator.clipboard)!=null&&h.write)){n==null||n(new Error("Clipboard API not available"));return}try{let k=(y=l.current)==null?void 0:y.closest('[data-streamdown="table-wrapper"]'),C=k==null?void 0:k.querySelector("table");if(!C){n==null||n(new Error("Table not found"));return}let M=le(C),P=a==="csv"?ce(M):nt(M),E=new ClipboardItem({"text/plain":new Blob([P],{type:"text/plain"}),"text/html":new Blob([C.outerHTML],{type:"text/html"})});await navigator.clipboard.write([E]),r(!0),m(!1),o==null||o(a),c.current=window.setTimeout(()=>r(!1),d);}catch(k){n==null||n(k);}};useEffect(()=>{let a=h=>{let y=h.composedPath();l.current&&!y.includes(l.current)&&m(false);};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a),window.clearTimeout(c.current);}},[]);let f=i?J:F;return jsxs("div",{className:"relative",ref:l,children:[jsx("button",{className:b("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",t),disabled:u,onClick:()=>m(!s),title:"Copy table",type:"button",children:e!=null?e:jsx(f,{size:14})}),s?jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>p("csv"),title:"Copy table as CSV",type:"button",children:"CSV"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>p("tsv"),title:"Copy table as TSV",type:"button",children:"TSV"})]}):null]})};var dt=({children:e,className:t,onDownload:o,onError:n})=>{let[d,s]=useState(false),m=useRef(null),{isAnimating:i}=useContext(N),r=l=>{var c;try{let u=(c=m.current)==null?void 0:c.closest('[data-streamdown="table-wrapper"]'),p=u==null?void 0:u.querySelector("table");if(!p){n==null||n(new Error("Table not found"));return}let f=le(p),a=l==="csv"?ce(f):rt(f);B(`table.${l==="csv"?"csv":"md"}`,a,l==="csv"?"text/csv":"text/markdown"),s(!1),o==null||o(l);}catch(u){n==null||n(u);}};return useEffect(()=>{let l=c=>{let u=c.composedPath();m.current&&!u.includes(m.current)&&s(false);};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l);}},[]),jsxs("div",{className:"relative",ref:m,children:[jsx("button",{className:b("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",t),disabled:i,onClick:()=>s(!d),title:"Download table",type:"button",children:e!=null?e:jsx(z,{size:14})}),d?jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>r("csv"),title:"Download table as CSV",type:"button",children:"CSV"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>r("markdown"),title:"Download table as Markdown",type:"button",children:"Markdown"})]}):null]})};var pt=({children:e,className:t,showControls:o,...n})=>jsxs("div",{className:"my-4 flex flex-col space-y-2","data-streamdown":"table-wrapper",children:[o?jsxs("div",{className:"flex items-center justify-end gap-1",children:[jsx(lt,{}),jsx(dt,{})]}):null,jsx("div",{className:"overflow-x-auto",children:jsx("table",{className:b("w-full border-collapse border border-border",t),"data-streamdown":"table",...n,children:e})})]});var Oo=lazy(()=>import('./code-block-37QAKDTI.js').then(e=>({default:e.CodeBlock}))),Ao=lazy(()=>import('./mermaid-4DMBBIKO.js').then(e=>({default:e.Mermaid}))),qo=/language-([^\s]+)/;function ge(e,t){if(!(e!=null&&e.position||t!=null&&t.position))return  true;if(!(e!=null&&e.position&&(t!=null&&t.position)))return  false;let o=e.position.start,n=t.position.start,d=e.position.end,s=t.position.end;return (o==null?void 0:o.line)===(n==null?void 0:n.line)&&(o==null?void 0:o.column)===(n==null?void 0:n.column)&&(d==null?void 0:d.line)===(s==null?void 0:s.line)&&(d==null?void 0:d.column)===(s==null?void 0:s.column)}function T(e,t){return e.className===t.className&&ge(e.node,t.node)}var Ne=(e,t)=>typeof e=="boolean"?e:e[t]!==false,ue=(e,t)=>{if(typeof e=="boolean")return e;let o=e.mermaid;return o===false?false:o===true||o===void 0?true:o[t]!==false},Se=memo(({children:e,className:t,node:o,...n})=>jsx("ol",{className:b("list-inside list-decimal whitespace-normal [li_&]:pl-6",t),"data-streamdown":"ordered-list",...n,children:e}),(e,t)=>T(e,t));Se.displayName="MarkdownOl";var bt=memo(({children:e,className:t,node:o,...n})=>jsx("li",{className:b("py-1 [&>p]:inline",t),"data-streamdown":"list-item",...n,children:e}),(e,t)=>e.className===t.className&&ge(e.node,t.node));bt.displayName="MarkdownLi";var gt=memo(({children:e,className:t,node:o,...n})=>jsx("ul",{className:b("list-inside list-disc whitespace-normal [li_&]:pl-6",t),"data-streamdown":"unordered-list",...n,children:e}),(e,t)=>T(e,t));gt.displayName="MarkdownUl";var ht=memo(({className:e,node:t,...o})=>jsx("hr",{className:b("my-6 border-border",e),"data-streamdown":"horizontal-rule",...o}),(e,t)=>T(e,t));ht.displayName="MarkdownHr";var yt=memo(({children:e,className:t,node:o,...n})=>jsx("span",{className:b("font-semibold",t),"data-streamdown":"strong",...n,children:e}),(e,t)=>T(e,t));yt.displayName="MarkdownStrong";var zo=({children:e,className:t,href:o,node:n,...d})=>{let{linkSafety:s}=useContext(N),[m,i]=useState(false),r=o==="streamdown:incomplete-link",l=useCallback(async f=>{if(!(!(s!=null&&s.enabled&&o)||r)){if(f.preventDefault(),s.onLinkCheck&&await s.onLinkCheck(o)){window.open(o,"_blank","noreferrer");return}i(true);}},[s,o,r]),c=useCallback(()=>{o&&window.open(o,"_blank","noreferrer");},[o]),u=useCallback(()=>{i(false);},[]),p={url:o!=null?o:"",isOpen:m,onClose:u,onConfirm:c};return s!=null&&s.enabled&&o?jsxs(Fragment,{children:[jsx("button",{className:b("wrap-anywhere appearance-none text-left font-medium text-primary underline",t),"data-incomplete":r,"data-streamdown":"link",onClick:l,type:"button",children:e}),s.renderModal?s.renderModal(p):jsx(Fe,{...p})]}):jsx("a",{className:b("wrap-anywhere font-medium text-primary underline",t),"data-incomplete":r,"data-streamdown":"link",href:o,rel:"noreferrer",target:"_blank",...d,children:e})},wt=memo(zo,(e,t)=>T(e,t)&&e.href===t.href);wt.displayName="MarkdownA";var kt=memo(({children:e,className:t,node:o,...n})=>jsx("h1",{className:b("mt-6 mb-2 font-semibold text-3xl",t),"data-streamdown":"heading-1",...n,children:e}),(e,t)=>T(e,t));kt.displayName="MarkdownH1";var vt=memo(({children:e,className:t,node:o,...n})=>jsx("h2",{className:b("mt-6 mb-2 font-semibold text-2xl",t),"data-streamdown":"heading-2",...n,children:e}),(e,t)=>T(e,t));vt.displayName="MarkdownH2";var Ct=memo(({children:e,className:t,node:o,...n})=>jsx("h3",{className:b("mt-6 mb-2 font-semibold text-xl",t),"data-streamdown":"heading-3",...n,children:e}),(e,t)=>T(e,t));Ct.displayName="MarkdownH3";var xt=memo(({children:e,className:t,node:o,...n})=>jsx("h4",{className:b("mt-6 mb-2 font-semibold text-lg",t),"data-streamdown":"heading-4",...n,children:e}),(e,t)=>T(e,t));xt.displayName="MarkdownH4";var Pt=memo(({children:e,className:t,node:o,...n})=>jsx("h5",{className:b("mt-6 mb-2 font-semibold text-base",t),"data-streamdown":"heading-5",...n,children:e}),(e,t)=>T(e,t));Pt.displayName="MarkdownH5";var Mt=memo(({children:e,className:t,node:o,...n})=>jsx("h6",{className:b("mt-6 mb-2 font-semibold text-sm",t),"data-streamdown":"heading-6",...n,children:e}),(e,t)=>T(e,t));Mt.displayName="MarkdownH6";var Tt=memo(({children:e,className:t,node:o,...n})=>{let{controls:d}=useContext(N),s=Ne(d,"table");return jsx(pt,{className:t,showControls:s,...n,children:e})},(e,t)=>T(e,t));Tt.displayName="MarkdownTable";var Nt=memo(({children:e,className:t,node:o,...n})=>jsx("thead",{className:b("bg-muted/80",t),"data-streamdown":"table-header",...n,children:e}),(e,t)=>T(e,t));Nt.displayName="MarkdownThead";var Lt=memo(({children:e,className:t,node:o,...n})=>jsx("tbody",{className:b("divide-y divide-border bg-muted/40",t),"data-streamdown":"table-body",...n,children:e}),(e,t)=>T(e,t));Lt.displayName="MarkdownTbody";var St=memo(({children:e,className:t,node:o,...n})=>jsx("tr",{className:b("border-border border-b",t),"data-streamdown":"table-row",...n,children:e}),(e,t)=>T(e,t));St.displayName="MarkdownTr";var Rt=memo(({children:e,className:t,node:o,...n})=>jsx("th",{className:b("whitespace-nowrap px-4 py-2 text-left font-semibold text-sm",t),"data-streamdown":"table-header-cell",...n,children:e}),(e,t)=>T(e,t));Rt.displayName="MarkdownTh";var It=memo(({children:e,className:t,node:o,...n})=>jsx("td",{className:b("px-4 py-2 text-sm",t),"data-streamdown":"table-cell",...n,children:e}),(e,t)=>T(e,t));It.displayName="MarkdownTd";var Ht=memo(({children:e,className:t,node:o,...n})=>jsx("blockquote",{className:b("my-4 border-muted-foreground/30 border-l-4 pl-4 text-muted-foreground italic",t),"data-streamdown":"blockquote",...n,children:e}),(e,t)=>T(e,t));Ht.displayName="MarkdownBlockquote";var Et=memo(({children:e,className:t,node:o,...n})=>jsx("sup",{className:b("text-sm",t),"data-streamdown":"superscript",...n,children:e}),(e,t)=>T(e,t));Et.displayName="MarkdownSup";var Dt=memo(({children:e,className:t,node:o,...n})=>jsx("sub",{className:b("text-sm",t),"data-streamdown":"subscript",...n,children:e}),(e,t)=>T(e,t));Dt.displayName="MarkdownSub";var Vt=memo(({children:e,className:t,node:o,...n})=>{if("data-footnotes"in n){let s=r=>{var p,f;if(!isValidElement(r))return  false;let l=Array.isArray(r.props.children)?r.props.children:[r.props.children],c=false,u=false;for(let a of l)if(a){if(typeof a=="string")a.trim()!==""&&(c=true);else if(isValidElement(a))if(((p=a.props)==null?void 0:p["data-footnote-backref"])!==void 0)u=true;else {let h=Array.isArray(a.props.children)?a.props.children:[a.props.children];for(let y of h){if(typeof y=="string"&&y.trim()!==""){c=true;break}if(isValidElement(y)&&((f=y.props)==null?void 0:f["data-footnote-backref"])===void 0){c=true;break}}}}return u&&!c},m=Array.isArray(e)?e.map(r=>{if(!isValidElement(r))return r;if(r.type===Se){let c=(Array.isArray(r.props.children)?r.props.children:[r.props.children]).filter(u=>!s(u));return c.length===0?null:{...r,props:{...r.props,children:c}}}return r}):e;return (Array.isArray(m)?m.some(r=>r!==null):m!==null)?jsx("section",{className:t,...n,children:m}):null}return jsx("section",{className:t,...n,children:e})},(e,t)=>T(e,t));Vt.displayName="MarkdownSection";var $o=({node:e,className:t,children:o,...n})=>{var p,f,a;let d=((p=e==null?void 0:e.position)==null?void 0:p.start.line)===((f=e==null?void 0:e.position)==null?void 0:f.end.line),{mermaid:s,controls:m}=useContext(N),i=U();if(d)return jsx("code",{className:b("rounded bg-muted px-1.5 py-0.5 font-mono text-sm",t),"data-streamdown":"inline-code",...n,children:o});let r=t==null?void 0:t.match(qo),l=(a=r==null?void 0:r.at(1))!=null?a:"",c="";if(isValidElement(o)&&o.props&&typeof o.props=="object"&&"children"in o.props&&typeof o.props.children=="string"?c=o.props.children:typeof o=="string"&&(c=o),l==="mermaid"&&i){let h=Ne(m,"mermaid"),y=ue(m,"download"),k=ue(m,"copy"),C=ue(m,"fullscreen"),M=ue(m,"panZoom"),P=h&&(y||k||C);return jsx(Suspense,{fallback:jsx(Pe,{}),children:jsxs("div",{className:b("group relative my-4 h-auto rounded-xl border p-4",t),"data-streamdown":"mermaid-block",children:[P?jsxs("div",{className:"flex items-center justify-end gap-2",children:[y?jsx(Ye,{chart:c,config:s==null?void 0:s.config}):null,k?jsx(Ce,{code:c}):null,C?jsx(ot,{chart:c,config:s==null?void 0:s.config}):null]}):null,jsx(Ao,{chart:c,config:s==null?void 0:s.config,showControls:M})]})})}let u=Ne(m,"code");return jsx(Suspense,{fallback:jsx(Pe,{}),children:jsx(Oo,{className:b("overflow-x-auto border-border border-t",t),code:c,language:l,children:u?jsxs(Fragment,{children:[jsx(We,{code:c,language:l}),jsx(Ce,{})]}):null})})},Bt=memo($o,(e,t)=>e.className===t.className&&ge(e.node,t.node));Bt.displayName="MarkdownCode";var jt=memo(Xe,(e,t)=>e.className===t.className&&ge(e.node,t.node));jt.displayName="MarkdownImg";var Ot=memo(({children:e,className:t,node:o,...n})=>{var m,i;let s=(Array.isArray(e)?e:[e]).filter(r=>r!=null&&r!=="");if(s.length===1&&isValidElement(s[0])){let r=s[0].props.node,l=r==null?void 0:r.tagName;if(l==="img")return jsx(Fragment,{children:e});if(l==="code"&&((m=r==null?void 0:r.position)==null?void 0:m.start.line)!==((i=r==null?void 0:r.position)==null?void 0:i.end.line))return jsx(Fragment,{children:e})}return jsx("p",{className:t,...n,children:e})},(e,t)=>T(e,t));Ot.displayName="MarkdownParagraph";var At={ol:Se,li:bt,ul:gt,hr:ht,strong:yt,a:wt,h1:kt,h2:vt,h3:Ct,h4:xt,h5:Pt,h6:Mt,table:Tt,thead:Nt,tbody:Lt,tr:St,th:Rt,td:It,blockquote:Ht,code:Bt,img:jt,pre:({children:e})=>e,sup:Et,sub:Dt,p:Ot,section:Vt};var qt=[],zt={allowDangerousHtml:true},he=new WeakMap,Re=class{constructor(){this.cache=new Map;this.keyCache=new WeakMap;this.maxSize=100;}generateCacheKey(t){let o=this.keyCache.get(t);if(o)return o;let n=t.rehypePlugins,d=t.remarkPlugins,s=t.remarkRehypeOptions;if(!(n||d||s)){let u="default";return this.keyCache.set(t,u),u}let m=u=>{if(!u||u.length===0)return "";let p="";for(let f=0;f<u.length;f+=1){let a=u[f];if(f>0&&(p+=","),Array.isArray(a)){let[h,y]=a;if(typeof h=="function"){let k=he.get(h);k||(k=h.name,he.set(h,k)),p+=k;}else p+=String(h);p+=":",p+=JSON.stringify(y);}else if(typeof a=="function"){let h=he.get(a);h||(h=a.name,he.set(a,h)),p+=h;}else p+=String(a);}return p},i=m(n),r=m(d),l=s?JSON.stringify(s):"",c=`${r}::${i}::${l}`;return this.keyCache.set(t,c),c}get(t){let o=this.generateCacheKey(t),n=this.cache.get(o);return n&&(this.cache.delete(o),this.cache.set(o,n)),n}set(t,o){let n=this.generateCacheKey(t);if(this.cache.size>=this.maxSize){let d=this.cache.keys().next().value;d&&this.cache.delete(d);}this.cache.set(n,o);}clear(){this.cache.clear();}},$t=new Re,Ie=e=>{let t=Ko(e),o=e.children||"";return Yo(t.runSync(t.parse(o),o),e)},Ko=e=>{let t=$t.get(e);if(t)return t;let o=Go(e);return $t.set(e,o),o},Go=e=>{let t=e.rehypePlugins||qt,o=e.remarkPlugins||qt,n=e.remarkRehypeOptions?{...zt,...e.remarkRehypeOptions}:zt;return unified().use(Jo).use(o).use(Fo,n).use(t)},Yo=(e,t)=>toJsxRuntime(e,{Fragment:Fragment,components:t.components,ignoreInvalidStyle:true,jsx:jsx,jsxs:jsxs,passKeys:true,passNode:true});var en=/\[\^[^\]\s]{1,200}\](?!:)/,tn=/\[\^[^\]\s]{1,200}\]:/,on=/<\/(\w+)>/,nn=/<(\w+)[\s>]/,He=e=>{let t=0;for(;t<e.length&&(e[t]===" "||e[t]==="	"||e[t]===`
`||e[t]==="\r");)t+=1;return t+1<e.length&&e[t]==="$"&&e[t+1]==="$"},rn=e=>{let t=e.length-1;for(;t>=0&&(e[t]===" "||e[t]==="	"||e[t]===`
`||e[t]==="\r");)t-=1;return t>=1&&e[t]==="$"&&e[t-1]==="$"},Ee=e=>{let t=0;for(let o=0;o<e.length-1;o+=1)e[o]==="$"&&e[o+1]==="$"&&(t+=1,o+=1);return t},De=e=>{let t=en.test(e),o=tn.test(e);if(t||o)return [e];let n=Lexer.lex(e,{gfm:true}),d=[],s=[];for(let m of n){let i=m.raw,r=d.length;if(s.length>0){if(d[r-1]+=i,m.type==="html"){let c=i.match(on);if(c){let u=c[1];s.at(-1)===u&&s.pop();}}continue}if(m.type==="html"&&m.block){let c=i.match(nn);if(c){let u=c[1];i.includes(`</${u}>`)||s.push(u);}}if(i.trim()==="$$"&&r>0){let c=d[r-1],u=He(c),p=Ee(c);if(u&&p%2===1){d[r-1]=c+i;continue}}if(r>0&&rn(i)){let c=d[r-1],u=He(c),p=Ee(c),f=Ee(i);if(u&&p%2===1&&!He(i)&&f===1){d[r-1]=c+i;continue}}d.push(i);}return d};var gn={raw:pn,sanitize:[un,{}],harden:[harden,{allowedImagePrefixes:["*"],allowedLinkPrefixes:["*"],allowedProtocols:["*"],defaultOrigin:void 0,allowDataImages:true}]},hn={gfm:[fn,{}]},yn=Object.values(gn),wn=Object.values(hn),kn={block:" \u258B",circle:" \u25CF"},vn={shikiTheme:["github-light","github-dark"],controls:true,isAnimating:false,mode:"streaming",mermaid:void 0,linkSafety:{enabled:true}},N=createContext(vn),Wt=memo(({content:e,shouldParseIncompleteMarkdown:t,index:o,...n})=>jsx(Ie,{...n,children:e}),(e,t)=>{if(e.content!==t.content||e.index!==t.index)return  false;if(e.components!==t.components){let o=Object.keys(e.components||{}),n=Object.keys(t.components||{});if(o.length!==n.length||o.some(d=>{var s,m;return ((s=e.components)==null?void 0:s[d])!==((m=t.components)==null?void 0:m[d])}))return  false}return !(e.rehypePlugins!==t.rehypePlugins||e.remarkPlugins!==t.remarkPlugins)});Wt.displayName="Block";var Cn=["github-light","github-dark"],xn=memo(({children:e,mode:t="streaming",parseIncompleteMarkdown:o=true,components:n,rehypePlugins:d=yn,remarkPlugins:s=wn,className:m,shikiTheme:i=Cn,mermaid:r,controls:l=true,isAnimating:c=false,BlockComponent:u=Wt,parseMarkdownIntoBlocksFn:p=De,caret:f,plugins:a,remend:h,linkSafety:y={enabled:true},...k})=>{let C=useId(),[M,P]=useTransition(),E=useMemo(()=>typeof e!="string"?"":t==="streaming"&&o?bn(e,h):e,[e,t,o,h]),L=useMemo(()=>p(E),[E,p]),[D,A]=useState(L);useEffect(()=>{t==="streaming"?P(()=>{A(L);}):A(L);},[L,t]);let j=t==="streaming"?D:L,q=useMemo(()=>j.map((S,W)=>`${C}-${W}`),[j.length,C]),V=useMemo(()=>{var S,W;return {shikiTheme:(W=(S=a==null?void 0:a.code)==null?void 0:S.getThemes())!=null?W:i,controls:l,isAnimating:c,mode:t,mermaid:r,linkSafety:y}},[i,l,c,t,r,y,a==null?void 0:a.code]),w=useMemo(()=>({...At,...n}),[n]),R=useMemo(()=>{let S=[];return a!=null&&a.cjk&&(S=[...S,...a.cjk.remarkPluginsBefore]),S=[...S,...s],a!=null&&a.cjk&&(S=[...S,...a.cjk.remarkPluginsAfter]),a!=null&&a.math&&(S=[...S,a.math.remarkPlugin]),S},[s,a==null?void 0:a.math,a==null?void 0:a.cjk]),Y=useMemo(()=>a!=null&&a.math?[...d,a.math.rehypePlugin]:d,[d,a==null?void 0:a.math]),Ut=useMemo(()=>f&&c?{"--streamdown-caret":`"${kn[f]}"`}:void 0,[f,c]);return t==="static"?jsx(ie.Provider,{value:a!=null?a:null,children:jsx(N.Provider,{value:V,children:jsx("div",{className:b("space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0",m),children:jsx(Ie,{components:w,rehypePlugins:Y,remarkPlugins:R,...k,children:e})})})}):jsx(ie.Provider,{value:a!=null?a:null,children:jsx(N.Provider,{value:V,children:jsxs("div",{className:b("space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0",f?"*:last:after:inline *:last:after:align-baseline *:last:after:content-(--streamdown-caret)":null,m),style:Ut,children:[j.length===0&&f&&c&&jsx("span",{}),j.map((S,W)=>jsx(u,{components:w,content:S,index:W,rehypePlugins:Y,remarkPlugins:R,shouldParseIncompleteMarkdown:o,...k},q[W]))]})})})},(e,t)=>e.children===t.children&&e.shikiTheme===t.shikiTheme&&e.isAnimating===t.isAnimating&&e.mode===t.mode&&e.plugins===t.plugins&&e.className===t.className&&e.linkSafety===t.linkSafety);xn.displayName="Streamdown";var Ft=({children:e,className:t,minZoom:o=.5,maxZoom:n=3,zoomStep:d=.1,showControls:s=true,initialZoom:m=1,fullscreen:i=false})=>{let r=useRef(null),l=useRef(null),[c,u]=useState(m),[p,f]=useState({x:0,y:0}),[a,h]=useState(false),[y,k]=useState({x:0,y:0}),[C,M]=useState({x:0,y:0}),P=useCallback(w=>{u(R=>Math.max(o,Math.min(n,R+w)));},[o,n]),E=useCallback(()=>{P(d);},[P,d]),L=useCallback(()=>{P(-d);},[P,d]),D=useCallback(()=>{u(m),f({x:0,y:0});},[m]),A=useCallback(w=>{w.preventDefault();let R=w.deltaY>0?-d:d;P(R);},[P,d]),j=useCallback(w=>{if(w.button!==0||w.isPrimary===false)return;h(true),k({x:w.clientX,y:w.clientY}),M(p);let R=w.currentTarget;R instanceof HTMLElement&&R.setPointerCapture(w.pointerId);},[p]),q=useCallback(w=>{if(!a)return;w.preventDefault();let R=w.clientX-y.x,Y=w.clientY-y.y;f({x:C.x+R,y:C.y+Y});},[a,y,C]),V=useCallback(w=>{h(false);let R=w.currentTarget;R instanceof HTMLElement&&R.releasePointerCapture(w.pointerId);},[]);return useEffect(()=>{let w=r.current;if(w)return w.addEventListener("wheel",A,{passive:false}),()=>{w.removeEventListener("wheel",A);}},[A]),useEffect(()=>{let w=l.current;if(w&&a)return document.body.style.userSelect="none",w.addEventListener("pointermove",q,{passive:false}),w.addEventListener("pointerup",V),w.addEventListener("pointercancel",V),()=>{document.body.style.userSelect="",w.removeEventListener("pointermove",q),w.removeEventListener("pointerup",V),w.removeEventListener("pointercancel",V);}},[a,q,V]),jsxs("div",{className:b("relative flex flex-col",i?"h-full w-full":"min-h-28 w-full",t),ref:r,style:{cursor:a?"grabbing":"grab"},children:[s?jsxs("div",{className:b("absolute z-10 flex flex-col gap-1 rounded-md border border-border bg-background/90 p-1 shadow-sm backdrop-blur-sm",i?"bottom-4 left-4":"bottom-2 left-2"),children:[jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",disabled:c>=n,onClick:E,title:"Zoom in",type:"button",children:jsx(Ae,{size:16})}),jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",disabled:c<=o,onClick:L,title:"Zoom out",type:"button",children:jsx(qe,{size:16})}),jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",onClick:D,title:"Reset zoom and pan",type:"button",children:jsx(Oe,{size:16})})]}):null,jsx("div",{className:b("flex-1 origin-center transition-transform duration-150 ease-out",i?"flex h-full w-full items-center justify-center":"flex w-full items-center justify-center"),onPointerDown:j,ref:l,role:"application",style:{transform:`translate(${p.x}px, ${p.y}px) scale(${c})`,transformOrigin:"center center",touchAction:"none",willChange:"transform"},children:e})]})};var tt=({chart:e,className:t,config:o,fullscreen:n=false,showControls:d=true})=>{let[s,m]=useState(null),[i,r]=useState(false),[l,c]=useState(""),[u,p]=useState(""),[f,a]=useState(0),{mermaid:h}=useContext(N),y=U(),k=h==null?void 0:h.errorComponent,{shouldRender:C,containerRef:M}=Ve({immediate:n});if(useEffect(()=>{if(!C)return;if(!y){m("Mermaid plugin not available. Please add the mermaid plugin to enable diagram rendering.");return}(async()=>{try{m(null),r(!0);let L=y.getMermaid(o),D=e.split("").reduce((q,V)=>(q<<5)-q+V.charCodeAt(0)|0,0),A=`mermaid-${Math.abs(D)}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{svg:j}=await L.render(A,e);c(j),p(j);}catch(L){if(!(u||l)){let D=L instanceof Error?L.message:"Failed to render Mermaid chart";m(D);}}finally{r(false);}})();},[e,o,f,C,y]),!(C||l||u))return jsx("div",{className:b("my-4 min-h-[200px]",t),ref:M});if(i&&!l&&!u)return jsx("div",{className:b("my-4 flex justify-center p-4",t),ref:M,children:jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-current border-b-2"}),jsx("span",{className:"text-sm",children:"Loading diagram..."})]})});if(s&&!l&&!u){let E=()=>a(L=>L+1);return k?jsx("div",{ref:M,children:jsx(k,{chart:e,error:s,retry:E})}):jsxs("div",{className:b("rounded-lg border border-red-200 bg-red-50 p-4",t),ref:M,children:[jsxs("p",{className:"font-mono text-red-700 text-sm",children:["Mermaid Error: ",s]}),jsxs("details",{className:"mt-2",children:[jsx("summary",{className:"cursor-pointer text-red-600 text-xs",children:"Show Code"}),jsx("pre",{className:"mt-2 overflow-x-auto rounded bg-red-100 p-2 text-red-800 text-xs",children:e})]})]})}let P=l||u;return jsx("div",{className:b("size-full",t),"data-streamdown":"mermaid",ref:M,children:jsx(Ft,{className:b(n?"size-full overflow-hidden":"my-4 overflow-hidden",t),fullscreen:n,maxZoom:3,minZoom:.5,showControls:d,zoomStep:.1,children:jsx("div",{"aria-label":"Mermaid chart",className:b("flex justify-center",n?"size-full items-center":null),dangerouslySetInnerHTML:{__html:P},role:"img"})})})};export{b as a,ao as b,cr as c,tt as d,De as e,gn as f,hn as g,N as h,Wt as i,xn as j};